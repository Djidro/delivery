<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FoodExpress MVP - Talabat Style</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://maps.googleapis.com/maps/api/js?key=YOUR_GOOGLE_MAPS_KEY"></script>
    <style>
        .screen { display: none; min-height: 100vh; padding: 20px; }
        .active { display: block; }
        .card { background: white; padding: 15px; border-radius: 12px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); margin-bottom: 15px; }
        #map { height: 300px; width: 100%; border-radius: 12px; margin-top: 15px; }
    </style>
</head>
<body class="bg-gray-100">

    <div id="app">
        <section id="screen-auth" class="screen active text-center">
            <h1 class="text-3xl font-bold text-red-500 my-10">FoodExpress</h1>
            <button onclick="showScreen('customer')" class="w-full bg-red-500 text-white p-4 rounded-lg mb-4">I am a Customer</button>
            <button onclick="showScreen('restaurant')" class="w-full bg-gray-800 text-white p-4 rounded-lg mb-4">I am a Restaurant</button>
            <button onclick="showScreen('driver')" class="w-full bg-blue-600 text-white p-4 rounded-lg">I am a Driver</button>
        </section>

        <section id="screen-customer" class="screen">
            <h2 class="text-xl font-bold mb-4">Select Items</h2>
            <div id="menu-items" class="card">
                <p>Pizza Margherita - $12</p>
                <button onclick="placeOrder('Pizza Margherita', 12)" class="bg-red-500 text-white px-4 py-2 rounded mt-2">Order Now</button>
            </div>
            <div id="customer-status" class="hidden">
                <div class="card bg-orange-100">
                    <h3 class="font-bold">Order Tracking</h3>
                    <p id="track-status" class="text-2xl text-orange-600">Waiting...</p>
                </div>
                <div id="map"></div>
            </div>
        </section>

        <section id="screen-restaurant" class="screen">
            <h2 class="text-xl font-bold mb-4">Kitchen Orders</h2>
            <div id="order-list-restaurant"></div>
        </section>

        <section id="screen-driver" class="screen">
            <h2 class="text-xl font-bold mb-4">Delivery Tasks</h2>
            <div id="order-list-driver"></div>
        </section>
    </div>

    <script type="module">
    // Import the database connection
    import { db } from './firebase-config.js';
    import { collection, addDoc, onSnapshot, doc, updateDoc, query, where, serverTimestamp } 
    from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

    // IMPORTANT: This makes the function "global" so the buttons can see it
    window.showScreen = (role) => {
        console.log("Switching to role:", role); // Check your browser console (F12)
        
        // 1. Hide all screens
        const screens = document.querySelectorAll('.screen');
        screens.forEach(s => s.classList.remove('active'));
        screens.forEach(s => s.classList.add('hidden'));

        // 2. Show the selected screen
        const target = document.getElementById(`screen-${role}`);
        if (target) {
            target.classList.add('active');
            target.classList.remove('hidden');
        } else {
            console.error("Screen not found: screen-" + role);
        }

        // 3. Initialize specific logic
        if(role === 'restaurant') initRestaurant();
        if(role === 'driver') initDriver();
    };

    // --- PASTE YOUR REMAINING LOGIC (placeOrder, initRestaurant, etc.) BELOW THIS LINE ---
    
    // Example placeOrder to ensure it's global
    window.placeOrder = async (name, price) => {
        // ... (use the code from previous message)
    };
</script>

</body>
</html>
